<!--
 * @Author: 明华
 * @Date: 2021-01-29 14:52:42
 * @LastEditors: 明华
 * @LastEditTime: 2021-03-18 14:13:46
 * @Description:
 * @FilePath: /frontend-training/specification/readme.md
-->



# 前端规范

[石墨链接](https://shimo.im/docs/gXqmev4wlNTQ9Kqo)

## 团队小目标

1. 团队产出
2. 团队凝聚力
3. 前端网站

## 目的

1. 有利于大家合作开发。
2. 让别人愿意接手你的代码。
3. 提高个人代码能力。

## 业务逻辑（重要性 1）

1. 路由逻辑：路由需要和页面状态对应起来
   - 路由相当于页面的唯一 ID
   - 数据流转和 UI 渲染都是从路由开始的
   - 路由和数据流转和 UI 渲染要做到一一对应
   - 锚点
2. 数据流转逻辑
   - 使用数据实体定义数据模型，字段作用需要注释清楚。
   - 发起请求过程（获取数据）
     - 线性发起请求：禁止使用回调方式，使用异步函数。
     - 无限制并发请求
     - 有限制并发请求：例如传图片
   - 如何驱动 UI 渲染
     - 进入 UI 前处理好数据
     - 清洗函数：放到 model 层中调用，例如 reducer。
3. UI 渲染逻辑
   - 生命周期函数放到最前
   - 渲染逻辑放到中间
   - render 放到最后
   - 每个文件只允许有一个类
   - 独立功能封装在单独文件中，本身的一部分可以封装成函数或者直接写在 render 中。
   - readme.md 文件描述页面中最重要的逻辑实现

## 代码组织（重要性 2）：可维护性（最重要）、通用性、可扩展性、易用性、健壮性

- 模块划分
  - 界定好模块边界
- 模块封装
  - 把核心逻辑封装在一个地方，其他方式都是对核心逻辑的调用。

实施过程：需要开会讨论

1. 自己模块：
   - 可维护性
2. 给他人调用的模块：
   - 可维护性
   - 准确性
   - 容错能力
3. 公用模块
   - 可维护性
   - 准确性
   - 容错能力
   - 易用性和通用性的权衡

## 其他共用规则（重要性 3）

1. 可编辑页面要做到数据完整性，数据不全，禁止页面操作。
   - (接口数据实体中可以增加接口请求 loading 状态)
   - 针对接口 loading（能够修改数据库的接口）：控制性、灵活性更强。
   - redux 自带针对页面 loading
2. 错误处理：需要大家补全
   - 数据空值情况：1，给定默认值；2，?. 取值，3，三元运算符。
   - 业务层面错误处理；
     - 应用：统一错误处理
     - api: 统一错误处理 + 单独接口错误处理。
3. 防止多次点击同一个按钮的问题。
   - 防抖函数
   - 接口 loading
   - 锁定按钮的变量，不要存储在有重新渲染风险的组件内，可以定义到组件外。
